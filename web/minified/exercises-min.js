var exerciseSelectionScreen=function(k,f){var s={LOADING:"loading"};var g=entity(k,f);var q=document.getElementById("exerciseList"),o,b,r;(function p(){var u=document.getElementById("backButtonExerciseSelectionScreen");r=entity(u,{}).on("select",e)}());g.loadExercisesBySubject=function(u){c(u.exercises["href"]);return this};g.getSelectedExercise=function(){return b};function a(u){l(u.getData()["href"])}function e(){g.fireEvent("back")}function c(u){var v=new XMLHttpRequest();var w=[];v.onreadystatechange=function(){if(v.readyState==4&&v.status==200){w=JSON.parse(v.responseText)["exercises"];h();n(w)}};v.addEventListener("progress",t,false);v.addEventListener("load",j,false);v.addEventListener("error",i,false);v.addEventListener("abort",d,false);v.open("GET",u,true);v.send();k.classList.add(s.LOADING)}function t(u){if(u.lengthComputable){var v=u.loaded/u.total;logIt("progress: "+v)}else{}}function j(u){k.classList.remove(s.LOADING);logIt(u);var v=u.target;var w=JSON.parse(v.responseText)["exercises"];h();n(w)}function i(u){alert("An error occurred while transferring the file.")}function d(u){alert("The transfer has been canceled by the user.")}function l(u){var v=new XMLHttpRequest();v.onreadystatechange=function(){if(v.readyState==4&&v.status==200){b=JSON.parse(v.responseText)["exercise"];g.fireEvent("exerciseSelected")}};v.open("GET",u,false);v.send(null)}function n(v){for(var u=0;u<v.length;u++){m(v[u])}}function h(){while(q.lastChild){q.removeChild(q.lastChild)}}function m(w){var u=document.createElement("li");u.innerHTML=w.title;q.appendChild(u);var v=entity(u,w);v.on("select",a);return v}return g};